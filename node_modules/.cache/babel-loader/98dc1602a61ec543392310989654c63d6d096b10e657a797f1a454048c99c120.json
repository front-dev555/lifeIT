{"ast":null,"code":"import { put, takeLatest, select, call, cancelled, race } from 'redux-saga/effects';\nimport { createOperationSuccessAction, createLoadingEndAction } from './actions';\nimport { ActionTypes } from './actionTypes';\nimport { makeOperation } from '../api';\nconst selectValue = state => state.value;\nfunction* handleOperation(currentValue, delta) {\n  try {\n    const result = yield call(makeOperation, currentValue, delta);\n    yield put(createOperationSuccessAction(result));\n  } finally {\n    if (yield cancelled()) {\n      console.log('Operation was cancelled');\n    }\n    yield put(createLoadingEndAction());\n  }\n}\nfunction* handleIncrement() {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, 1),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function* () {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\nfunction* handleDecrement() {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, -1),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function* () {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\nfunction* handleIncrementByValue(action) {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, action.payload),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function* () {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\nfunction* handleDecrementByValue(action) {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, -action.payload),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function* () {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\nexport function* rootSaga() {\n  yield takeLatest(ActionTypes.INCREMENT_ASYNC, handleIncrement);\n  yield takeLatest(ActionTypes.DECREMENT_ASYNC, handleDecrement);\n  yield takeLatest(ActionTypes.INCREMENT_BY_VALUE_ASYNC, handleIncrementByValue);\n  yield takeLatest(ActionTypes.DECREMENT_BY_VALUE_ASYNC, handleDecrementByValue);\n}","map":{"version":3,"names":["put","takeLatest","select","call","cancelled","race","createOperationSuccessAction","createLoadingEndAction","ActionTypes","makeOperation","selectValue","state","value","handleOperation","currentValue","delta","result","console","log","handleIncrement","operation","cancel","CANCEL_ALL_OPERATIONS","handleDecrement","handleIncrementByValue","action","payload","handleDecrementByValue","rootSaga","INCREMENT_ASYNC","DECREMENT_ASYNC","INCREMENT_BY_VALUE_ASYNC","DECREMENT_BY_VALUE_ASYNC"],"sources":["/Users/donpindyukel/Downloads/test-project/src/ducks/sagas.ts"],"sourcesContent":["import {\n  put,\n  takeLatest,\n  select,\n  call,\n  SelectEffect,\n  CallEffect,\n  PutEffect,\n  cancelled,\n  CancelledEffect,\n  race,\n  RaceEffect,\n} from 'redux-saga/effects';\nimport {\n  createOperationSuccessAction,\n  createIncrementByValueAction,\n  createDecrementByValueAction,\n  createLoadingEndAction,\n  AppAction\n} from './actions';\nimport { ActionTypes } from './actionTypes';\nimport { makeOperation } from '../api';\nimport { AppState } from './types';\n\ntype SagaEffect =\n  | SelectEffect\n  | CallEffect<number>\n  | CallEffect<void>\n  | PutEffect<AppAction>\n  | CancelledEffect\n  | RaceEffect<{\n      operation: CallEffect<number>;\n      cancel: CallEffect<void>;\n    }>;\n\nconst selectValue: (state: AppState) => number = (state) => state.value;\n\nfunction* handleOperation(currentValue: number, delta: number): Generator<SagaEffect, void, number> {\n  try {\n    const result = yield call(makeOperation, currentValue, delta);\n    yield put(createOperationSuccessAction(result));\n  } finally {\n    if (yield cancelled()) {\n      console.log('Operation was cancelled');\n    }\n    yield put(createLoadingEndAction());\n  }\n}\n\nfunction* handleIncrement(): Generator<SagaEffect, void, number> {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, 1),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function*() {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\n\nfunction* handleDecrement(): Generator<SagaEffect, void, number> {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, -1),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function*() {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\n\nfunction* handleIncrementByValue(action: ReturnType<typeof createIncrementByValueAction>): Generator<SagaEffect, void, number> {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, action.payload),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function*() {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\n\nfunction* handleDecrementByValue(action: ReturnType<typeof createDecrementByValueAction>): Generator<SagaEffect, void, number> {\n  const currentValue = yield select(selectValue);\n  yield race({\n    operation: call(handleOperation, currentValue, -action.payload),\n    cancel: takeLatest(ActionTypes.CANCEL_ALL_OPERATIONS, function*() {\n      yield put(createLoadingEndAction());\n    })\n  });\n}\n\nexport function* rootSaga() {\n  yield takeLatest(ActionTypes.INCREMENT_ASYNC, handleIncrement);\n  yield takeLatest(ActionTypes.DECREMENT_ASYNC, handleDecrement);\n  yield takeLatest(ActionTypes.INCREMENT_BY_VALUE_ASYNC, handleIncrementByValue);\n  yield takeLatest(ActionTypes.DECREMENT_BY_VALUE_ASYNC, handleDecrementByValue);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}